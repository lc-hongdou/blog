# copy_to_hexo.py
import os
import shutil
import time


def copy_to_hexo():
    local_list = os.listdir(LOCAL_ARTICLE_PATH)
    hexo_list = os.listdir(HEXO_ARTICLE_PATH)
    flag = True
    for file in local_list:
        if file in IGNORE_LIST:
            continue
        if file.endswith('.md'):
            local_version = os.path.join(LOCAL_ARTICLE_PATH, file)
            hexo_version = os.path.join(HEXO_ARTICLE_PATH, file)
            if file not in hexo_list:
                flag = False
                print("新增文章: %s..." % file,
                      "最后修改时间：%s" % TimeStampFormat(os.path.getmtime(local_version)))
                shutil.copy(local_version, hexo_version)
            elif os.path.getmtime(local_version) > os.path.getmtime(hexo_version):
                flag = False
                print("更新文章: %s..." % file,
                      "上次修改时间：%s" % TimeStampFormat(os.path.getmtime(hexo_version)),
                      "最后修改时间：%s" % TimeStampFormat(os.path.getmtime(local_version)))
                shutil.copy(local_version, hexo_version)
    print('文章无变化' if flag else '更新完毕')


# 时间格式标准化
def TimeStampFormat(timestamp):
    return time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(timestamp))


IGNORE_LIST = ['欢迎使用Markdown编辑器.md']
HEXO_ARTICLE_PATH = 'D:\hexoblog\source\_posts'
LOCAL_ARTICLE_PATH = 'D:/Markdown'

copy_to_hexo()
